<% layout('layouts/boilerplate') %>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

<style>
  body {
    background: linear-gradient(135deg, #2B6CB0 0%, #38B2AC 100%);
    min-height: 100vh;
  }
  
  .map-container {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    border: 1px solid rgba(255,255,255,0.3);
  }
  
  #map {
    width: 100%;
    height: 600px;
    border-radius: 15px;
    z-index: 1;
  }
  
  .controls-panel {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    border: 1px solid rgba(255,255,255,0.3);
  }
  
  .privacy-toggle {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }
  
  .radius-control {
    margin: 1rem 0;
  }
  
  .status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: 0.875rem;
    font-weight: 600;
  }
  
  .status-in-transit { background: #ffc107; color: #000; }
  .status-at-destination { background: #28a745; color: #fff; }
  .status-at-home { background: #6c757d; color: #fff; }
  .status-planning { background: #17a2b8; color: #fff; }
  
  .compatibility-score {
    font-weight: bold;
    padding: 0.25rem 0.5rem;
    border-radius: 8px;
    display: inline-block;
    margin-left: 0.5rem;
  }
  
  .score-high { background: #28a745; color: white; }
  .score-medium { background: #ffc107; color: black; }
  .score-low { background: #dc3545; color: white; }
</style>

<div class="container my-4">
  <div class="controls-panel">
    <h2 class="mb-4">
      <i class="fa-solid fa-map-location-dot me-2"></i>Interactive Travel Map
    </h2>
    
    <div class="row">
      <div class="col-md-6">
        <div class="privacy-toggle">
          <label class="form-label fw-bold">Location Sharing:</label>
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="locationSharingToggle">
            <label class="form-check-label" for="locationSharingToggle">
              <span id="sharingStatus">Off</span>
            </label>
          </div>
        </div>
        
        <div class="mb-3">
          <label class="form-label fw-bold">Privacy Level:</label>
          <select class="form-select" id="privacyLevel">
            <option value="exact">Exact Location</option>
            <option value="city">City Level</option>
            <option value="country">Country Level</option>
            <option value="hidden">Hidden</option>
          </select>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="mb-3">
          <label class="form-label fw-bold">Travel Status:</label>
          <select class="form-select" id="travelStatus">
            <option value="at-home">At Home</option>
            <option value="in-transit">In Transit</option>
            <option value="at-destination">At Destination</option>
            <option value="planning">Planning</option>
          </select>
        </div>
        
        <div class="radius-control">
          <label class="form-label fw-bold">Search Radius: <span id="radiusValue">50</span> km</label>
          <input type="range" class="form-range" id="radiusSlider" min="5" max="500" value="50" step="5">
        </div>
      </div>
    </div>
    
    <button class="btn btn-primary" id="refreshMap">
      <i class="fa-solid fa-sync-alt me-2"></i>Refresh Map
    </button>
  </div>
  
  <div class="map-container">
    <div id="map"></div>
  </div>
</div>

<script src="/js/map.js"></script>

